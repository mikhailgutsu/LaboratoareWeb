{"ast":null,"code":"import _initializerDefineProperty from \"C:/Users/VARZARI/Documents/GitHub/Lab1_VarzariNicolae_CR-212/my-react-project/my-app/node_modules/@babel/runtime/helpers/esm/initializerDefineProperty.js\";\nimport _applyDecoratedDescriptor from \"C:/Users/VARZARI/Documents/GitHub/Lab1_VarzariNicolae_CR-212/my-react-project/my-app/node_modules/@babel/runtime/helpers/esm/applyDecoratedDescriptor.js\";\nimport _initializerWarningHelper from \"C:/Users/VARZARI/Documents/GitHub/Lab1_VarzariNicolae_CR-212/my-react-project/my-app/node_modules/@babel/runtime/helpers/esm/initializerWarningHelper.js\";\nvar _class,\n  _descriptor,\n  _s = $RefreshSig$();\nimport { createContext, useContext } from 'react';\nimport { observable, action } from 'mobx';\nexport class LocalStorageManager {\n  constructor(prefix) {\n    let storage = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : localStorage;\n    this.prefix = void 0;\n    this.storage = void 0;\n    this.prefix = prefix;\n    this.storage = storage;\n  }\n  setItem(key, value) {\n    this.storage.setItem(`${this.prefix}-${key}`, JSON.stringify(value));\n  }\n  getItem(key) {\n    const value = this.storage.getItem(`${this.prefix}-${key}`);\n    return value ? JSON.parse(value) : null;\n  }\n}\nexport let MyStore = (_class = class MyStore {\n  constructor(storageManager) {\n    this.storageManager = void 0;\n    _initializerDefineProperty(this, \"data\", _descriptor, this);\n    this.storageManager = storageManager;\n  }\n  setData(data) {\n    this.data = data;\n    this.storageManager.setItem('data', data);\n  }\n  modifyData(modifier) {\n    if (this.data === null) {\n      return;\n    }\n    const modifiedData = modifier(this.data);\n    this.data = modifiedData;\n    this.storageManager.setItem('data', modifiedData);\n  }\n  async loadData() {\n    return new Promise(resolve => {\n      setTimeout(() => {\n        const data = this.storageManager.getItem('data');\n        if (data) {\n          this.setData(data);\n        }\n        resolve(data);\n      }, 2000);\n    });\n  }\n}, (_descriptor = _applyDecoratedDescriptor(_class.prototype, \"data\", [observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function () {\n    return null;\n  }\n}), _applyDecoratedDescriptor(_class.prototype, \"setData\", [action], Object.getOwnPropertyDescriptor(_class.prototype, \"setData\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"modifyData\", [action], Object.getOwnPropertyDescriptor(_class.prototype, \"modifyData\"), _class.prototype)), _class);\nconst storageManager = new LocalStorageManager('lab5');\nconst StoreContext = /*#__PURE__*/createContext(new MyStore(storageManager));\nexport const useStore = () => {\n  _s();\n  return useContext(StoreContext);\n};\n_s(useStore, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");","map":{"version":3,"names":["createContext","useContext","observable","action","LocalStorageManager","constructor","prefix","storage","localStorage","setItem","key","value","JSON","stringify","getItem","parse","MyStore","storageManager","setData","data","modifyData","modifier","modifiedData","loadData","Promise","resolve","setTimeout","StoreContext","useStore"],"sources":["C:/Users/VARZARI/Documents/GitHub/Lab1_VarzariNicolae_CR-212/my-react-project/my-app/src/MyStore.ts"],"sourcesContent":["import { createContext, useContext } from 'react';\r\nimport { observable, action } from 'mobx';\r\n\r\ninterface ILocalStorage {\r\n    getItem(key: string): any;\r\n    setItem(key: string, value: any): void;\r\n}\r\n\r\nexport class LocalStorageManager {\r\n    prefix: string;\r\n    storage: ILocalStorage;\r\n\r\n    constructor(prefix: string, storage: ILocalStorage = localStorage) {\r\n        this.prefix = prefix;\r\n        this.storage = storage;\r\n    }\r\n\r\n    setItem(key: string, value: any) {\r\n        this.storage.setItem(`${this.prefix}-${key}`, JSON.stringify(value));\r\n    }\r\n\r\n    getItem(key: string) {\r\n        const value = this.storage.getItem(`${this.prefix}-${key}`);\r\n        return value ? JSON.parse(value) : null;\r\n    }\r\n}\r\n\r\nexport class MyStore<T> {\r\n    storageManager: LocalStorageManager;\r\n    @observable data: T | null = null;\r\n\r\n    constructor(storageManager: LocalStorageManager) {\r\n        this.storageManager = storageManager;\r\n    }\r\n\r\n    @action setData(data: T) {\r\n        this.data = data;\r\n        this.storageManager.setItem('data', data);\r\n    }\r\n\r\n    @action modifyData(modifier: (data: T) => T) {\r\n        if (this.data === null) {\r\n            return;\r\n        }\r\n        const modifiedData = modifier(this.data);\r\n        this.data = modifiedData;\r\n        this.storageManager.setItem('data', modifiedData);\r\n    }\r\n\r\n    async loadData() {\r\n        return new Promise((resolve) => {\r\n            setTimeout(() => {\r\n                const data = this.storageManager.getItem('data');\r\n                if (data) {\r\n                    this.setData(data);\r\n                }\r\n                resolve(data);\r\n            }, 2000);\r\n        });\r\n    }\r\n}\r\n\r\nconst storageManager = new LocalStorageManager('lab5');\r\nconst StoreContext = createContext(new MyStore(storageManager));\r\nexport const useStore = () => useContext(StoreContext);\r\n"],"mappings":";;;;;;AAAA,SAASA,aAAa,EAAEC,UAAU,QAAQ,OAAO;AACjD,SAASC,UAAU,EAAEC,MAAM,QAAQ,MAAM;AAOzC,OAAO,MAAMC,mBAAmB,CAAC;EAI7BC,WAAW,CAACC,MAAc,EAAyC;IAAA,IAAvCC,OAAsB,uEAAGC,YAAY;IAAA,KAHjEF,MAAM;IAAA,KACNC,OAAO;IAGH,IAAI,CAACD,MAAM,GAAGA,MAAM;IACpB,IAAI,CAACC,OAAO,GAAGA,OAAO;EAC1B;EAEAE,OAAO,CAACC,GAAW,EAAEC,KAAU,EAAE;IAC7B,IAAI,CAACJ,OAAO,CAACE,OAAO,CAAE,GAAE,IAAI,CAACH,MAAO,IAAGI,GAAI,EAAC,EAAEE,IAAI,CAACC,SAAS,CAACF,KAAK,CAAC,CAAC;EACxE;EAEAG,OAAO,CAACJ,GAAW,EAAE;IACjB,MAAMC,KAAK,GAAG,IAAI,CAACJ,OAAO,CAACO,OAAO,CAAE,GAAE,IAAI,CAACR,MAAO,IAAGI,GAAI,EAAC,CAAC;IAC3D,OAAOC,KAAK,GAAGC,IAAI,CAACG,KAAK,CAACJ,KAAK,CAAC,GAAG,IAAI;EAC3C;AACJ;AAEA,WAAaK,OAAO,aAAb,MAAMA,OAAO,CAAI;EAIpBX,WAAW,CAACY,cAAmC,EAAE;IAAA,KAHjDA,cAAc;IAAA;IAIV,IAAI,CAACA,cAAc,GAAGA,cAAc;EACxC;EAEQC,OAAO,CAACC,IAAO,EAAE;IACrB,IAAI,CAACA,IAAI,GAAGA,IAAI;IAChB,IAAI,CAACF,cAAc,CAACR,OAAO,CAAC,MAAM,EAAEU,IAAI,CAAC;EAC7C;EAEQC,UAAU,CAACC,QAAwB,EAAE;IACzC,IAAI,IAAI,CAACF,IAAI,KAAK,IAAI,EAAE;MACpB;IACJ;IACA,MAAMG,YAAY,GAAGD,QAAQ,CAAC,IAAI,CAACF,IAAI,CAAC;IACxC,IAAI,CAACA,IAAI,GAAGG,YAAY;IACxB,IAAI,CAACL,cAAc,CAACR,OAAO,CAAC,MAAM,EAAEa,YAAY,CAAC;EACrD;EAEA,MAAMC,QAAQ,GAAG;IACb,OAAO,IAAIC,OAAO,CAAEC,OAAO,IAAK;MAC5BC,UAAU,CAAC,MAAM;QACb,MAAMP,IAAI,GAAG,IAAI,CAACF,cAAc,CAACH,OAAO,CAAC,MAAM,CAAC;QAChD,IAAIK,IAAI,EAAE;UACN,IAAI,CAACD,OAAO,CAACC,IAAI,CAAC;QACtB;QACAM,OAAO,CAACN,IAAI,CAAC;MACjB,CAAC,EAAE,IAAI,CAAC;IACZ,CAAC,CAAC;EACN;AACJ,CAAC,sEA/BIjB,UAAU;EAAA;EAAA;EAAA;EAAA;IAAA,OAAkB,IAAI;EAAA;AAAA,4DAMhCC,MAAM,+IAKNA,MAAM;AAsBX,MAAMc,cAAc,GAAG,IAAIb,mBAAmB,CAAC,MAAM,CAAC;AACtD,MAAMuB,YAAY,gBAAG3B,aAAa,CAAC,IAAIgB,OAAO,CAACC,cAAc,CAAC,CAAC;AAC/D,OAAO,MAAMW,QAAQ,GAAG;EAAA;EAAA,OAAM3B,UAAU,CAAC0B,YAAY,CAAC;AAAA;AAAC,GAA1CC,QAAQ"},"metadata":{},"sourceType":"module","externalDependencies":[]}